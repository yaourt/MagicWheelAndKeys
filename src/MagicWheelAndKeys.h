#pragma once

#include <assert.h>
#include <iostream>
#include <vector>
#include <shellapi.h>
#include "resource.h"


const UINT TRAY_ICON = 1;
const BOOL TRAY_POPUP_MENU_SHOWN = FALSE;

const DWORD VENDORID = 0x0000045E;
const DWORD PRODUCTID = 0x00000048;

void AddTrayIcon(HWND hWnd);
void RemoveTrayIcon(HWND hWnd);
void ShowTrayIconPopupMenu(HWND hWnd);

void ListenHIDMessages(HWND hWnd);
void HandleInput(HWND hwnd, UINT uMsg, WPARAM wParam, LPARAM lParam);
void HandleScancode(DWORD64 scancode);

void WheelInput(INT nbWheelClick, INPUT** lpinput, UINT& nbinputs);
void KeyboardInput(UINT nbkeys, WORD* keys, INPUT** lpinputs, UINT& nbinputs);

void PaintIt(HDC hdc);

// 01 00 00 00 04 00 00 00
const DWORD64 KEY_PREVIOUS = 0x0000000400000001;

// 01 00 00 00 08 00 00 00
const DWORD64     KEY_NEXT = 0x0000000800000001;

// 01 00 00 00 00 00 01 00
const DWORD64 KEY_SCROLLUP_SLOWER = 0x0001000000000001;
// 01 00 00 00 00 00 21 00
const DWORD64   KEY_SCROLLUP_SLOW = 0x0021000000000001;
// 01 00 00 00 00 00 41 00
const DWORD64   KEY_SCROLLUP_FAST = 0x0041000000000001;
// 01 00 00 00 00 00 61 00
const DWORD64 KEY_SCROLLUP_FASTER = 0x0061000000000001;

// 01 00 00 00 00 00 1f 00
const DWORD64 KEY_SCROLLDOWN_SLOWER = 0x001F000000000001;
// 01 00 00 00 00 00 3f 00
const DWORD64   KEY_SCROLLDOWN_SLOW = 0x003F000000000001;
// 01 00 00 00 00 00 5f 00
const DWORD64   KEY_SCROLLDOWN_FAST = 0x005F000000000001;
// 01 00 00 00 00 00 7f 00
const DWORD64 KEY_SCROLLDOWN_FASTER = 0x007F000000000001;


// 01 00 00 40 00 00 00 00
const DWORD64 KEY_CUT   = 0x0000000040000001;
// 01 00 00 20 00 00 00 00
const DWORD64 KEY_COPY  = 0x0000000020000001;
// 01 00 00 80 00 00 00 00
const DWORD64 KEY_PASTE = 0x0000000080000001;

// 01 00 08 00 00 00 00 00
const DWORD64 KEY_APP_BACK = 0x0000000000080001;
// 01 00 04 00 00 00 00 00
const DWORD64 KEY_APP_FWD  = 0x0000000000040001;

// 01 00 00 10 00 00 00 00
const DWORD64 KEY_UNDO  = 0x0000000010000001;
// 01 00 00 00 10 00 00 00
const DWORD64 KEY_REDO    = 0x0000001000000001;

// 01 10 00 00 00 00 00 00
const DWORD64 KEY_WORD    = 0x0000000000001001;
// 01 20 00 00 00 00 00 00
const DWORD64 KEY_EXCEL   = 0x0000000000002001;
// 01 00 00 00 02 00 00 00
const DWORD64 KEY_WEB     = 0x0000000200000001;
// 01 40 00 00 00 00 00 00
const DWORD64 KEY_EMAIL      = 0x0000000000004001;
// 01 80 00 00 00 00 00 00
const DWORD64 KEY_CALENDAR   = 0x0000000000008001;
// 01 00 40 00 00 00 00 00
const DWORD64 KEY_FILE       = 0x0000000000400001;
// 01 00 01 00 00 00 00 00
const DWORD64 KEY_CALC       = 0x0000000000010001;


// 01 00 02 00 00 00 00 00
const DWORD64 KEY_LOGOUT       = 0x0000000000020001;

// ???
//const DWORD64 KEY_SLEEP        = 0x0000000000000000;

// 01 08 00 00 00 00 00 00
const DWORD64 KEY_VOL_PLUS  = 0x0000000000000801;
// 01 04 00 00 00 00 00 00
const DWORD64 KEY_VOL_MINUS = 0x0000000000000401;
// 01 02 00 00 00 00 00 00
const DWORD64 KEY_VOL_MUTE  = 0x0000000000000201;


// 01 01 00 00 00 00 00 00
const DWORD64 KEY_HELP        = 0x0000000000000101;
// 01 00 00 00 01 00 00 00
const DWORD64 KEY_OFFICE_HOME = 0x0000000100000001;
// 01 00 10 00 00 00 00 00
const DWORD64 KEY_TASK_PANEL  = 0x0000000000100001;
// 01 00 80 00 00 00 00 00
const DWORD64 KEY_NEW         = 0x0000000000800001;
// 01 00 00 01 00 00 00 00
const DWORD64 KEY_OPEN        = 0x0000000001000001;
// 01 00 00 02 00 00 00 00
const DWORD64 KEY_CLOSE       = 0x0000000002000001;
// 01 00 00 00 20 00 00 00
const DWORD64 KEY_REPLY       = 0x0000002000000001;
// 01 00 00 00 40 00 00 00
const DWORD64 KEY_FWD         = 0x0000004000000001;
// 01 00 00 00 80 00 00 00
const DWORD64 KEY_SEND        = 0x0000008000000001;
// 01 00 20 00 00 00 00 00
const DWORD64 KEY_SPELL       = 0x0000000000200001;
// 01 00 00 04 00 00 00 00
const DWORD64 KEY_SAVE        = 0x0000000004000001;
// 01 00 00 08 00 00 00 00
const DWORD64 KEY_PRINT       = 0x0000000008000001;

// 01 00 00 00 00 01 00 00
const DWORD64 KEY_EQUAL             = 0x0000010000000001;
// 01 00 00 00 00 02 00 00
const DWORD64 KEY_LEFT_PARENTHESIS  = 0x0000020000000001;
// 01 00 00 00 00 04 00 00
const DWORD64 KEY_RIGHT_PARENTHESIS = 0x0000040000000001;
